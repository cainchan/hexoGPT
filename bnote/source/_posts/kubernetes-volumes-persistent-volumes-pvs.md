---
title: Kubernetes卷详解：Volumes和Persistent Volumes（PVs）
tags:
  - Kubernetes
categories:
  - DevOps
date: 2023-05-30 10:11:18
author:
thumbnail:
blogexcerpt:
---
Kubernetes是一种流行的容器编排系统，它提供了许多方便的功能来管理容器应用程序。其中两个非常重要的概念是卷（Volumes）和持久卷（Persistent Volumes，PVs）。在本文中，我们将深入探讨这两个概念。

卷（Volumes）
Kubernetes的卷是一种抽象，用于将容器内部的文件系统与主机或其他容器共享数据。它们可以是临时的，也可以是持久的。临时卷只存活在容器生命周期中，当容器关闭后，卷就会被销毁。而持久卷则可以跨容器生命周期继续存在。Kubernetes支持多种类型的卷，包括空白卷、主机路径卷、配置映射卷和数据存储类卷等。

1. 空白卷
空白卷是最简单的卷类型，它只是一个空目录，可用于将数据从一个容器传输到另一个容器。空白卷不会保存数据，因此它们通常用于共享数据或通过共享卷来进行容器之间的通信。

2. 主机路径卷
主机路径卷将主机文件系统上的目录或文件挂载到容器中。这使得容器可以访问主机文件系统，并共享文件。但是，如果容器在不同的主机上运行，那么这种方法就无法使用。

3. 配置映射卷
配置映射卷将配置文件挂载到容器中。这样，容器就可以使用不同的环境变量或配置文件，而不需要对源代码进行更改。它们通常用于将应用程序配置数据注入到容器中，例如数据库连接字符串等。

4. 数据存储类卷
数据存储类卷是一种高级卷类型，它允许管理员为整个集群定义共享存储选项。数据存储类卷包括云存储、网络文件系统和分布式文件系统等。管理员可以通过数据存储类卷来管理存储，并使其在整个集群中可用。

持久卷（Persistent Volumes）
持久卷是 Kubernetes 中一个重要的概念，它提供了一种方式来将存储资源与应用程序分离开来。PVs 是集群中的一种资源，它表示一个特定的存储卷。PVs 可以被多个 Pod 共享，并且可以跨越多个节点共享。PVs 可以由管理员手动创建，也可以由 StorageClass 动态创建。

1. 手动创建 PVs
管理员可以手动创建 PV 并分配给应用程序使用。为此，管理员需要创建 PersistentVolume 资源并指定存储卷的大小、存储类和访问模式等信息。PV 资源与存储系统中的实际存储卷进行绑定，从而使其可用于 Pod。

2. 动态创建 PVs
StorageClass 是动态创建 PV 的一种方式。管理员可以定义一个或多个 StorageClass，并为每个 StorageClass 指定默认的存储类、支持的访问模式和卷大小范围等信息。当应用程序请求一个动态卷时，Kubernetes 会自动选择一个合适的 StorageClass 并动态创建一个 PV 来满足该请求。

结论
在 Kubernetes 中，卷和持久卷是两个非常重要的概念。卷提供了一种将容器内部的文件系统与主机或其他容器共享数据的方法。持久卷则提供了跨容器生命周期持久化存储资源
